/*!
 * Copyright 2017 ThoughtWorks, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@import "font-awesome/variables";
@import "font-awesome/mixins";

$CONSOLE_PASS: #99E343;
$CONSOLE_FAIL: #FF6B68;
$CONSOLE_CALLOUT: #FFA;
$CONSOLE_INFO: grey;
$CONSOLE_SETUP: #7992B0;
$CONSOLE_SETUP_ERR: #A567A5;;

.console-area {
  .ts {
    display: none;
  }

  &.with-timestamps .ts {
    display: inline;
    margin-right: 1ex;
  }
}

.buildoutput_pre {
  $height-of-non-console-log-elements: 500px;
  overflow: auto;

  white-space: pre;
  white-space: pre-wrap;
  word-break: break-all;
  word-wrap: break-word;

  padding-left: 10px;
  padding-bottom: 35px;

  min-height: 800px; // ie < 8
  min-height: calc(100vh - #{$height-of-non-console-log-elements});

  background-color: #333;
  color: white;

  .white-theme & {
    background-color: white;
    color: black;
  }

  font-family: Monaco, Consolas, Inconsolata, "Liberation Mono", "Courier New", monospace;
  font-size: 13px;
  line-height: 19px;

  .fa {
    font-family: FontAwesome;
  }

  @each $color in black, red, green, yellow, blue, magenta, cyan, white {
    .ansi-#{$color}-fg {
      color: $color;
    }

    .ansi-#{$color}-bg {
      background-color: $color;
    }

    .ansi-bright-#{$color}-fg {
      color: lighten($color, 33%);
    }

    .ansi-bright-#{$color}-bg {
      background-color: lighten($color, 33%);
    }
  }

  .foldable-section {
    margin-left: 20px;
    position: relative;

    dt, dd {
      position: relative;
      margin-left: 2.5rem;
      padding-left: 1ex;
    }

    [data-line]:before {
      position: absolute;
      content: attr(data-line);
      color: #666;
      left: -2.5rem;
      width: 2.5rem;
      text-align: right;

      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
    }

    [data-prefix="pr"] {
      color: $CONSOLE_SETUP;
    }

    [data-prefix="pe"] {
      color: $CONSOLE_SETUP_ERR;
    }
    [data-prefix="##"] {
      color: $CONSOLE_INFO;
    }

    [data-prefix="@@"] {
      color: $CONSOLE_FAIL;
    }

    [data-prefix="&2"], code {
      color: $CONSOLE_CALLOUT;
    }

    &[data-task-status], &[data-job-status] {

      &:before {
        @include fa-icon;
        position: absolute;
        left: -25px;
        top: 3px;
      }

      code {
        font-weight: bold;
      }
    }

    &[data-task-status="passed"], &[data-job-status="passed"] {

      &:before {
        content: $fa-var-check;
        color: $CONSOLE_PASS;
      }

      code {
        color: $CONSOLE_PASS;
      }
    }

    &[data-task-status="failed"], &[data-job-status="failed"] {
      &:before {
        content: $fa-var-times;
        color: red;
      }

      [data-prefix="&2"] {
        color: $CONSOLE_FAIL;
      }

      code {
        color: red;
      }
    }

    &[data-type="cancel"] {
      dt, [data-prefix] {
        color: $CONSOLE_SETUP;
      }

      [data-prefix="&2"], [data-prefix="x1"] {
        color: $CONSOLE_SETUP_ERR;
      }

      &[data-task-status="passed"] {
        &:before {
          display: none;
        }

        code {
          color: $CONSOLE_SETUP;
        }
      }

      &[data-task-status="failed"] {
        code {
          color: $CONSOLE_SETUP_ERR;
        }
      }
    }

    &[data-task-status="cancelled"] {
      &:before {
        content: $fa-var-ban;
        color: $CONSOLE_FAIL;
      }
    }

    [data-prefix="?0"] code, [data-prefix="j0"] code {
      color: $CONSOLE_PASS;
      font-weight: bold;
    }

    [data-prefix="?1"] code, [data-prefix="j1"] code {
      color: red;
      font-weight: bold;
    }

    dt[data-prefix], dt[data-line]:before {
      background: #383838;
    }

    dd {
      display: none;
    }

    .toggle {
      float: left;
      margin-left: -9px;
      cursor: pointer;
      text-decoration: none;
      color: inherit;

      &:before {
        content: $fa-var-caret-right;
      }
    }


    &.open {
      dd {
        display: block;
      }

      .toggle:before {
        content: $fa-var-caret-down;
      }
    }

  }
}

